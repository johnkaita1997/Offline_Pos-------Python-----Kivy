#:kivy 1.10.0
#:import utils kivy.utils
#: import Window kivy.core.window.Window
#: import datetime datetime

<FlatButton@ButtonBehavior+Label>:
    font_size: 14

<OpenDialog>:
    title: 'InputDialog'
    size_hint: None, None
    size: 400, 120
    auto_dismiss: False
    text: input.text
    lb_error: er

    BoxLayout:
        orientation: 'vertical'
        pos: self.pos
        size: root.size

        BoxLayout:
            orientation: 'horizontal'
            Label:
                text: 'Enter Value'

            TextInput:
                id: input
                multiline: False
                hint_text:'Age'
                input_filter: 'int'
                on_text: root.error = ''

        BoxLayout:
            orientation: 'horizontal'
            Button:
                text: 'Enter'
                background_color: 255,0,0,0.9
                on_press: root._enter()

            Button:
                text: 'Cancel'
                background_color: 0,1,255,0.7
                on_press: root._cancel()

        Label:
            id: er
            foreground_color: 1, 250, 100, 1
            color: 1, 0.67, 0, 1
            size_hint_y: None
            height: 0
            text: root.error


<PosWindow>:
    thebox : thebox
    id: main_win
    spacing: 3
    orientation: 'vertical'
    canvas.before:
        Color:
            rgb: utils.get_color_from_hex('#ffffff')
        Rectangle:
            size: self.size
            pos: self.pos

    BoxLayout:
        orientation: 'vertical'
        size_hint_y: None
        height: 80

        #THE BEGINNNING OF THE TOP BAR
        BoxLayout:
            size_hint_y: None
            height: 30

            Label:
                text: 'Cocab Tech Solutions POS'
                size_hint_x: .6
                bold: True
                color: (1,1,1,1)
                canvas.before:
                    Color:
                        rgb: utils.get_color_from_hex('#5B2437')
                    Rectangle:
                        size: self.size
                        pos: self.pos


            FlatButton:
                text: 'Logout'
                size_hint_x: .4
                height: 30
                bold: True
                color: (1,1,1,1)
                on_release: root.logout()
                canvas.before:
                    Color:
                        rgb: utils.get_color_from_hex('#5B2437')
                    Rectangle:
                        size: self.size
                        pos: self.pos


        #THE BEGINNING OF THE SECOND WAVE FULL
        BoxLayout:
            id: current
            size_hint_y: None
            height: 50
            canvas.before:
                Color:
                    rgba: (1,1,1, 1)
                Rectangle:
                    size: self.size
                    pos: self.pos
            Button:
                text: 'Current Item:'
                background_normal: ''
                background_color: (.06, .32, .32, 1)
                size_hint_x: .4
            Button:
                id: cur_product
                text: 'Default Product'
                background_normal: ''
                background_color: utils.get_color_from_hex('#505050')
            Button:
                id: cur_price
                text: '0.00'
                background_normal: ''
                background_color: (.06, .65, .65, 1)
                size_hint_x: .2
        #THE END OF THE SECOND WAVE FULL



    #SEARCH FOR A PRODUCT
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: None
        height: 30
        size_hint_x: 1
        id: searchBox
        spacing: 10
        canvas.before:
            Color:
                rgba: (1, 1, 1, 1)
            Rectangle:
                size: self.size
                pos: self.pos

        TextInput:
            write_tab: False
            id: qty_inp
            hint_text: 'Code | Product Name'
            size_hint_x: .7
            multiline: False
            on_text_validate: root.change_quantity()

        Button:
            size_hint_x: .3
            id: crud_remove
            text: 'Search'
            on_release: root.searchforproduct()

    #END OF SEARCH BOX LAYOUT #WILL NEED TO REMOVE THE WIDGET TO ADD ANEW ONE

    #BGN OF MAIN BOX LAYOUT
    BoxLayout:
        orientation: 'horizontal'
        size_hint_y: .7
        size_hint_x: 1
        id: searchBox
        spacing: 10
        canvas.before:
            Color:
                rgba: (1, .59, 1, 1)
            Rectangle:
                size: self.size
                pos: self.pos

        #THE LIST VIEW BOX
        BoxLayout:
            spacing: 30
            size_hint_y: 1
            size_hint_x: .4
            id: outerbox
            orientation: 'vertical'
            canvas.before:
                Color:
                    rgb: utils.get_color_from_hex('#5B2437')
                Rectangle:
                    size: self.size
                    pos: self.pos

            Spinner:
                id: thespinner
                text: "Select A Category"
                size_hint_x: 1
                size_hint_y: None
                height: 40

            StackLayout:
                padding: 10
                spacing: 10
                id: thebox
                size_hint_y: .8
                size_hint_x: 1
                canvas.before:
                    Color:
                        rgba: (1, 1, 1, 1)
                    Rectangle:
                        size: self.size
                        pos: self.pos

                Widget:

        #END OF THE LISTVIEW BOX

        #THIS IS THE MIDDLE LINE
        BoxLayout:
            orientation: 'vertical'
            size_hint_y: 1
            size_hint_x: .1
            id: searchBox
            spacing: 10
            canvas.before:
                Color:
                    rgb: utils.get_color_from_hex('#5B2437')
                Rectangle:
                    size: self.size
                    pos: self.pos

        #END OF THE MIDDLE LINE


        #THE BEGINNING OF THE LAST BAR
        BoxLayout:
            orientation: 'vertical'
            size_hint_x: .5
            id: searchBox
            size_hint_y: 1
            spacing: 5
            canvas.before:
                Color:
                    rgba: (1, 1, 1, 1)

                Rectangle:
                    size: self.size
                    pos: self.pos

            BoxLayout:
                size_hint_y: None
                height: 30
                orientation: 'horizontal'
                id: numberAndDiscount
                canvas.before:
                    Color:
                        rgb: utils.get_color_from_hex('#5B2437')

                    Rectangle:
                        size: self.size
                        pos: self.pos

                Label:
                    size_hint_x: .4

                TextInput:
                    size_hint_x: .3
                    write_tab: False
                    multiline: False
                    on_text_validate: root.change_quantity()
                    id: number
                    hint_text: 'Number of items'

                TextInput
                    write_tab: False
                    multiline: False
                    on_text_validate: root.change_discount()
                    size_hint_x: .3
                    id: discount
                    hint_text: 'Disc per prod'

            #BOX FOR SHOP NAME
            BoxLayout:
                size_hint_y: .1
                id: shoopnameHolder
                orientation: 'vertical'
                canvas.before:
                    Color:
                        rgb: utils.get_color_from_hex('#5B8537')

                    Rectangle:
                        size: self.size
                        pos: self.pos
                Label:
                    color: utils.get_color_from_hex('#ffffff')
                    text : "The Name Of Shop  ||  123 Main Street, SP\n Tel: 0729836000                   Date:" + datetime.datetime.today().strftime('%Y-%m-%d')

            #BOX FOR DYNAMIC ITEMS

            StackLayout:
                padding: 10
                size_hint_Y: 1
                size_hint_y: .8
                id: receipt_Preview

            #END OF THE DYNAMIC ITEMS


            #BEGIN OF LAST BOX
            BoxLayout:
                size_hint_y: .2
                id: theending
                orientation: 'vertical'
                Button:
                    id: thetotal
                    text: "Total : 0.0"
                BoxLayout:

                    Spinner:
                        id: payment_spinner
                        size_hint_x: .2
                        text: "Payment"

                    Button:
                        size_hint_x: .2
                        text: "clear"
                        on_release: root.clearWidgets()

                    Button:
                        size_hint_x: .2
                        text: "Print"
                        on_release: root.print_output()

        #THE END OF THE LAST BAR IS HERE

    BoxLayout:
        size_hint_y: None
        height: 30
        canvas.before:
            Color:
                rgb: utils.get_color_from_hex('#5B2437')
            Rectangle:
                pos: self.pos
                size: self.size
        id: footer
        Label:
            text: "System Maintained by Cocab Tech Solutions (0729836000)"



